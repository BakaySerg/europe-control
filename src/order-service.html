<!DOCTYPE html>
<html lang="en">

<head>
	<title>EuropeControl | Order Service</title>
	@@include('./include/head.html')
</head>

<body>
	<div class="wrapper">
		@@include('./include/icon-sprite.html')
		<div class="intro intro--sm" style="--bg1x: url(../img/order-service/intro.jpg); --bg2x:url(../img/order-service/intro-2x.jpg);">
			@@include('./include/header.html')
			<!-- s-intro -->
			<section class="s-intro">
				<div class="container intro__row">
					<div class="intro__text intro__text--lg">
						<h1 class="h1">Order Service</h1>
					</div>
				</div>
			</section>
		</div>

		<!-- s-simply -->
		<section class="s--simply s--muted-filled" id="step-1" data-active="true">
			<div class="container flex-sm mb-2">
				<div class="title">
					<h2 class="h2">Order Service</h2>
				</div>
				<div class="steps">
					<button type="button" class="btn step active">1</button>
					<button type="button" class="btn step" data-step="step-2" disabled>2</button>
				</div>
			</div>
			<div class="container">
				<h3 class="h3 h3--light mb-1">Select the services you want to order:</h3>
				<form id="opt-form" class="opt__list">
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-1" class="checkbox" type="checkbox" name="opt-1" value="Escrow service" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-1">Escrow service</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-2" class="checkbox" type="checkbox" name="opt-2" value="Trustee service" data-sum="150">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-2">Trustee service</label>
						<div class="opt__sum">€ 150</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-3" class="checkbox" type="checkbox" name="opt-3" value="Quality Control" data-sum="120">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-3">Quality Control</label>
						<div class="opt__sum">€ 120</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-4" class="checkbox" type="checkbox" name="opt-4" value="Quality Assurance" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-4">Quality Assurance</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-5" class="checkbox" type="checkbox" name="opt-5" value="Quality Management" data-sum="150">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-5">Quality Management</label>
						<div class="opt__sum">€ 150</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-6" class="checkbox" type="checkbox" name="opt-6" value="Inspection" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-6">Inspection</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-7" class="checkbox" type="checkbox" name="opt-7" value="Verification Of Conformity" data-sum="150">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-7">Verification Of Conformity</label>
						<div class="opt__sum">€ 150</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-8" class="checkbox" type="checkbox" name="opt-8" value="Company Search" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-8">Company Search</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-9" class="checkbox" type="checkbox" name="opt-9" value="Evaluation" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-9">Evaluation</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-10" class="checkbox" type="checkbox" name="opt-10" value="Certification" data-sum="150">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-10">Certification</label>
						<div class="opt__sum">€ 150</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-11" class="checkbox" type="checkbox" name="opt-11" value="Debits Collection service" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-11">Debits Collection service</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-12" class="checkbox" type="checkbox" name="opt-12" value="Consulting" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-12">Consulting</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-13" class="checkbox" type="checkbox" name="opt-13" value="Research & Advisory" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-13">Research & Advisory</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-14" class="checkbox" type="checkbox" name="opt-14" value="Risk Management" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-14">Risk Management</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-15" class="checkbox" type="checkbox" name="opt-15" value="Business Directory" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-15">Business Directory</label>
						<div class="opt__sum">€ 100</div>
					</div>
					<div class="opt__row">
						<label class="checkbox__trigger">
							<input id="opt-16" class="checkbox" type="checkbox" name="opt-16" value="Testing & Audit" data-sum="100">
							<i class="checkbox__switch"></i>
						</label>
						<label class="checkbox__descr" for="opt-16">Testing & Audit</label>
						<div class="opt__sum">€ 100</div>
					</div>
				</form>
				<div class="opt__cta">
					<div class="h3 h3--light">Total Payment:</div>
					<b class="opt__total">€ <span id="total">0</span></b>
					<button type="submit" class="btn btn--icon btn--yellow-filled btn--rounded" data-step="step-2" disabled>
						Continue
						<svg class="arrow" viewBox="0 0 32 32"><use xlink:href="#i-arrow"/></svg>
					</button>
				</div>
			</div>
		</section>

		<!-- 2 -->
		<section class="s--simply s--muted-filled" id="step-2" data-active="false">
			<div class="container flex-sm mb-2">
				<div class="title">
					<h2 class="h2">Order Service</h2>
				</div>
				<div class="steps">
					<button type="button" class="btn step" data-step="step-1">1</button>
					<button type="button" class="btn step active">2</button>
				</div>
			</div>
			<div class="container">
				<div class="lim-center pt-05">
					<div class="pay">
						<div class="pay__item">
							<div class="pay__logo">
								<img loading="lazy" src="img/order-service/visa-mastercard.png" alt="visa-mastercard" width="31" height="36">
							</div>
							<div class="h3">Credit Card</div>
						</div>
						<div class="pay__item">
							<div class="pay__logo">
								<img loading="lazy" src="img/order-service/pngwing.png" alt="pngwing" width="38" height="39">
							</div>
							<div class="h3">Bank Transfer</div>
						</div>
						<div class="pay__item">
							<div class="pay__logo">
								<img loading="lazy" src="img/order-service/sepa.png" alt="sepa" width="32" height="32">
							</div>
							<div class="h3">Sepa</div>
						</div>
					</div>
					<form action="#" class="form decor-texture decor-texture--3">
						<h3 class="h3 h3--light mb-1">Payment details:</h3>
						<div class="form__dual">
							<input type="text" name="f-name" class="form__input" placeholder="First Name *" minlength="2" required>
							<input type="text" name="l-name" class="form__input" placeholder="Last Name *" minlength="2" required>
						</div>
						<div class="form__dual">
							<input type="email" name="email" class="form__input" placeholder="Email *" minlength="2" required>
							<input type="tel" name="phone" class="form__input" placeholder="Phone" pattern="[0-9]{5,14}" inputmode="numeric">
						</div>
						<div class="form__single">
							<input type="text" name="card-num" class="form__input" placeholder="Cart Number *" minlength="6" data-mask="0000 0000 0000 0000" inputmode="numeric" required>
						</div>
						<div class="form__dual">
							<input type="text" name="card-date" class="form__input" placeholder="Expiration Date *" minlength="2" data-mask="00 / 00" inputmode="decimal" required>
							<input type="text" name="card-cvv" class="form__input" placeholder="CVV2/CVC2 *" data-mask="000" pattern="[0-9]*" inputmode="decimal" required>
						</div>

						<!-- selection results -->
						<input type="hidden" name="res" id="hidden-sum" value="0">
						<input type="hidden" name="res2" id="hidden-selected" value="0">

						<div class="form__cta pt-15">
							<div class="captcha"><img src="img/contacts/captcha.jpg" alt="captcha"></div>
							<div>
								<div class="form__secure">
									<svg class="icon" viewBox="0 0 32 32"><use xlink:href="#i-lock"/></svg>
									<span>Connection secure</span>
								</div>
								<button type="submit" class="btn btn--icon btn--yellow-filled btn--rounded">
									Submit
									<svg class="arrow" viewBox="0 0 32 32"><use xlink:href="#i-arrow"/></svg>
								</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</section>


	</div><!-- /wrapper -->
	@@include('./include/footer.html')
	<script src="js/main.js"></script>
	<script>
		const form = document.getElementById("opt-form");
		const resultField = document.getElementById("total");
		const hiddenInput = document.getElementById("hidden-sum");
		const hiddenInput2 = document.getElementById("hidden-selected");
		const btnNextStep = document.querySelectorAll("[data-step]");
		const sections = document.querySelectorAll("[data-active]");

		if (form) {
			let total = 0;
			let list = [];
			let checkboxes = form.querySelectorAll("input[type=checkbox]");
			let disabledBtns = [...btnNextStep].filter(elem => elem.disabled);

			form.addEventListener('change', function (e) {
				total = 0;
				list.length = 0;
				let checkboxesSelected = [...checkboxes].filter(elem => elem.checked);
				total = +checkboxesSelected.reduce((acc,item) => acc + Number(item.getAttribute("data-sum")), 0);
				[...checkboxesSelected].forEach(item => list.push(item.value));

				resultField.innerText = total;
				hiddenInput.value = total;
				hiddenInput2.value = `${list.join("; ")}`;

				if (list.length) {
					[...disabledBtns].forEach(item => { item.removeAttribute("disabled") });
				} else {
					[...disabledBtns].forEach(item => { item.setAttribute("disabled","") });
				}
			});
		};

		if (btnNextStep) {
			[...btnNextStep].forEach(item => {
				item.addEventListener('click', event => {
					let nextStepSection = document.getElementById(item.getAttribute("data-step"));
					if (!item.disabled) {
						[...sections].forEach(item => {
							item.setAttribute("data-active","false");
						});
						nextStepSection.setAttribute("data-active", "true");
						window.scrollTo({
							top: 280,
							behavior: "smooth"
						});
					}
				})
			})
		};
	</script>

	<script src="https://unpkg.com/imask"></script>
	<script>
		let elements = document.querySelectorAll("[data-mask]");
		[...elements].forEach(element => {
			let pattern = element.getAttribute('data-mask');
			let maskOptions = {
				mask: pattern,
				min: element.getAttribute('minlength')
			};
			let mask = IMask(element, maskOptions);
			mask.on("complete", function () { console.log(mask.value) });
		});
	</script>

	<script>
		if (document.forms[0] && window.FormData) {
				const form = document.querySelector(".form");

				let request = new XMLHttpRequest();
				request.open('POST', 'send-order-service.php', true);
				// request.setRequestHeader('accept', 'application/json');

				form.addEventListener('submit', function (event) {
					event.preventDefault();

					let formData = new FormData(form);
					// Sending data
					request.send(formData);
					request.onreadystatechange = function () {
						// <4 =  waiting response
						// if (request.readyState < 4) {}
						// 4 = response ready
						if (request.readyState === 4) {
							// 200 - 299 = success sending
							if (request.status == 200 && request.status < 300){
								form.reset();
								// setTimeout(() => statusMessage.classList.remove("form__popup--show", "form__popup--success"), 5000);
								document.location.href = 'form-thank.html'
							}
							else {
								document.location.href = 'form-fall.html'
							}
						}
					}
				});
			};
	</script>
</body>
</html>